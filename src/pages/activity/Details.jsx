import { useState, useEffect } from 'react';
import Layout from '../../components/layout'
import axios from 'axios';
import { useParams } from 'react-router-dom';
import copy from '../../utils/copy';
import { useSelector } from 'react-redux'
import Header from '../../components/header/Header';


const ItemView = ({created, id, money, person, cvu}) => {
    const fechaSlice = (f) => f.slice(0,10)

    const hourSlice = (h) => h.slice(11,-8)
    
    return (
        <div className='flex-col justify-center items-center text-center mt-6 ml-[17px] mr-4 max-w-[700px] lg:m-auto lg:mt-6'>
            <p className='font-medium leading-[16px] mb-3 text-sm'>Creada el {fechaSlice(created)}, {hourSlice(created)}</p>
            <div className='relative'>
                <span className='text-[#39528D] font-medium text-sm leading-[16px]'>Operación: {id}</span>
                <button className='p-0 bg-transparent border-none ml-2 absolute top-0' onClick={() => copy(id)}>
                    <svg width='17' height='20' viewBox='0 0 17 20' fill='none' xmlns='http://www.w3.org/2000/svg'>
                        <path d='M2 20C1.45 20 0.979167 19.8042 0.5875 19.4125C0.195833 19.0208 0 18.55 0 18V5C0 4.71667 0.0958333 4.47917 0.2875 4.2875C0.479167 4.09583 0.716667 4 1 4C1.28333 4 1.52083 4.09583 1.7125 4.2875C1.90417 4.47917 2 4.71667 2 5V18H12C12.2833 18 12.5208 18.0958 12.7125 18.2875C12.9042 18.4792 13 18.7167 13 19C13 19.2833 12.9042 19.5208 12.7125 19.7125C12.5208 19.9042 12.2833 20 12 20H2ZM6 16C5.45 16 4.97917 15.8042 4.5875 15.4125C4.19583 15.0208 4 14.55 4 14V2C4 1.45 4.19583 0.979167 4.5875 0.5875C4.97917 0.195833 5.45 0 6 0H15C15.55 0 16.0208 0.195833 16.4125 0.5875C16.8042 0.979167 17 1.45 17 2V14C17 14.55 16.8042 15.0208 16.4125 15.4125C16.0208 15.8042 15.55 16 15 16H6ZM6 14H15V2H6V14Z' fill='#10224D' />
                    </svg>
                </button>
            </div>

            <div className='h-14 bg-white rounded-[10px] flex justify-between p-4 mt-4 shadow-cardShadow'>
                <div className='flex gap-2'>
                    <svg width='20' height='20' viewBox='0 0 20 20' fill='none' xmlns='http://www.w3.org/2000/svg'>
                        <path d='M10 20C8.62778 20 7.33334 19.7375 6.11668 19.2125C4.90001 18.6875 3.83889 17.9722 2.93333 17.0667C2.02778 16.1611 1.3125 15.1 0.7875 13.8833C0.2625 12.6667 0 11.3722 0 10C0 8.61667 0.2625 7.31667 0.7875 6.1C1.3125 4.88333 2.02778 3.825 2.93333 2.925C3.83889 2.025 4.90001 1.3125 6.11668 0.7875C7.33334 0.2625 8.62778 0 10 0C11.3833 0 12.6833 0.2625 13.9 0.7875C15.1167 1.3125 16.175 2.025 17.075 2.925C17.975 3.825 18.6875 4.88333 19.2125 6.1C19.7375 7.31667 20 8.61667 20 10C20 11.3722 19.7375 12.6667 19.2125 13.8833C18.6875 15.1 17.975 16.1611 17.075 17.0667C16.175 17.9722 15.1167 18.6875 13.9 19.2125C12.6833 19.7375 11.3833 20 10 20ZM10 18.3334C12.3222 18.3334 14.2917 17.5222 15.9084 15.9C17.525 14.2778 18.3334 12.3111 18.3334 10C18.3334 7.67778 17.525 5.70833 15.9084 4.09165C14.2917 2.47498 12.3222 1.66665 10 1.66665C7.68888 1.66665 5.72222 2.47498 4.1 4.09165C2.47777 5.70833 1.66665 7.67778 1.66665 10C1.66665 12.3111 2.47777 14.2778 4.1 15.9C5.72222 17.5222 7.68888 18.3334 10 18.3334ZM9.975 17.1167C10.175 17.1167 10.3486 17.0403 10.4958 16.8875C10.6431 16.7347 10.7167 16.5584 10.7167 16.3584V15.8333C11.6611 15.7056 12.425 15.3722 13.0083 14.8333C13.5917 14.2944 13.8833 13.5722 13.8833 12.6667C13.8833 11.8556 13.6583 11.1806 13.2083 10.6417C12.7583 10.1028 11.9444 9.63333 10.7667 9.23333C9.73333 8.88889 9.02221 8.56112 8.63333 8.25C8.24444 7.93888 8.05 7.52777 8.05 7.01665C8.05 6.52777 8.22639 6.14443 8.57918 5.86665C8.93194 5.58888 9.42222 5.45 10.05 5.45C10.4278 5.45 10.7639 5.51944 11.0583 5.65833C11.3528 5.79721 11.6056 5.99998 11.8167 6.26665C11.95 6.42222 12.107 6.52917 12.2875 6.5875C12.4681 6.64583 12.6389 6.63333 12.8 6.55C13.0056 6.4611 13.1431 6.31527 13.2125 6.1125C13.282 5.90972 13.2556 5.72499 13.1333 5.55833C12.8556 5.16389 12.5153 4.84445 12.1125 4.6C11.7097 4.35555 11.2611 4.21111 10.7667 4.16668V3.64165C10.7667 3.44165 10.6931 3.26804 10.5458 3.12083C10.3986 2.97361 10.225 2.9 10.025 2.9C9.825 2.9 9.64861 2.97361 9.49583 3.12083C9.34306 3.26804 9.26668 3.44165 9.26668 3.64165V4.16668C8.42223 4.30556 7.75833 4.63333 7.275 5.15C6.79167 5.66667 6.55 6.28888 6.55 7.01665C6.55 7.82222 6.76806 8.46667 7.20418 8.95C7.64028 9.43333 8.40555 9.87778 9.5 10.2833C10.6389 10.7111 11.4042 11.0861 11.7959 11.4083C12.1875 11.7306 12.3834 12.15 12.3834 12.6667C12.3834 13.2167 12.1681 13.6597 11.7375 13.9959C11.307 14.332 10.7833 14.5 10.1667 14.5C9.65556 14.5 9.18888 14.3764 8.76665 14.1292C8.34443 13.882 8.0111 13.5278 7.76665 13.0667C7.66665 12.9 7.53332 12.7778 7.36665 12.7C7.2 12.6222 7.03056 12.6139 6.85833 12.675C6.63611 12.7583 6.48194 12.8972 6.39583 13.0917C6.30973 13.2861 6.32223 13.4806 6.43333 13.675C6.74444 14.2306 7.12778 14.6819 7.58333 15.0292C8.03889 15.3764 8.58334 15.6278 9.21668 15.7833V16.375C9.21668 16.575 9.29306 16.7486 9.44583 16.8958C9.59861 17.0431 9.775 17.1167 9.975 17.1167Z' fill='black' />
                    </svg>
                    <p className='font-semibold text-base leading-[19.5px]'>Ingresaste Dinero</p>
                </div>
                <span className='font-semibold text-base leading-[19.5px]'>${money}</span>
            </div>

            <div className='flex justify-start gap-3 bg-white h-[56px] mt-4 rounded-[10px] p-[18px] border-l-8 border-solid border-[#008744] shadow-cardShadow'>
                <svg width='20' height='20' viewBox='0 0 20 20' fill='none' xmlns='http://www.w3.org/2000/svg'>
                    <path d='M8.55 12.1167L6.2 9.76668C6.03888 9.60556 5.83888 9.525 5.6 9.525C5.36112 9.525 5.15556 9.61111 4.98333 9.78333C4.82223 9.94444 4.74168 10.1444 4.74168 10.3833C4.74168 10.6222 4.82223 10.8222 4.98333 10.9833L7.96668 13.9833C8.13334 14.15 8.32778 14.2333 8.55 14.2333C8.77222 14.2333 8.96666 14.15 9.13333 13.9833L15 8.11668C15.1722 7.94444 15.2583 7.73888 15.2583 7.5C15.2583 7.26112 15.1722 7.05556 15 6.88333C14.8278 6.72223 14.6195 6.64445 14.375 6.65C14.1306 6.65555 13.9278 6.73888 13.7667 6.9L8.55 12.1167ZM10 20C8.62778 20 7.33334 19.7375 6.11668 19.2125C4.90001 18.6875 3.83889 17.9722 2.93333 17.0667C2.02778 16.1611 1.3125 15.1 0.7875 13.8833C0.2625 12.6667 0 11.3722 0 10C0 8.61667 0.2625 7.31667 0.7875 6.1C1.3125 4.88333 2.02778 3.825 2.93333 2.925C3.83889 2.025 4.90001 1.3125 6.11668 0.7875C7.33334 0.2625 8.62778 0 10 0C11.3833 0 12.6833 0.2625 13.9 0.7875C15.1167 1.3125 16.175 2.025 17.075 2.925C17.975 3.825 18.6875 4.88333 19.2125 6.1C19.7375 7.31667 20 8.61667 20 10C20 11.3722 19.7375 12.6667 19.2125 13.8833C18.6875 15.1 17.975 16.1611 17.075 17.0667C16.175 17.9722 15.1167 18.6875 13.9 19.2125C12.6833 19.7375 11.3833 20 10 20Z' fill='#008744' />
                </svg>
                <h2 className='font-semibold text-base leading-[19.5px]'>Aprobada</h2>
            </div>

            <div className='bg-white flex gap-4 pl-4 pt-4 pb-4 mt-4 rounded-[10px] shadow-cardShadow'>
                <div>
                    <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'>
                        <path d='M4.26 18.75C5.52 17.87 6.77 17.195 8.01 16.725C9.25 16.255 10.58 16.02 12 16.02C13.42 16.02 14.755 16.255 16.005 16.725C17.255 17.195 18.51 17.87 19.77 18.75C20.65 17.67 21.275 16.58 21.645 15.48C22.015 14.38 22.2 13.22 22.2 12C22.2 9.1 21.225 6.675 19.275 4.725C17.325 2.775 14.9 1.8 12 1.8C9.1 1.8 6.675 2.775 4.725 4.725C2.775 6.675 1.8 9.1 1.8 12C1.8 13.22 1.99 14.38 2.37 15.48C2.75 16.58 3.38 17.67 4.26 18.75ZM11.9944 12.9C10.8381 12.9 9.865 12.5031 9.075 11.7094C8.285 10.9157 7.89 9.9407 7.89 8.78442C7.89 7.62814 8.28686 6.655 9.08058 5.865C9.8743 5.075 10.8493 4.68 12.0056 4.68C13.1619 4.68 14.135 5.07686 14.925 5.87058C15.715 6.6643 16.11 7.6393 16.11 8.79558C16.11 9.95186 15.7131 10.925 14.9194 11.715C14.1257 12.505 13.1507 12.9 11.9944 12.9ZM12.014 24C10.3647 24 8.81 23.685 7.35 23.055C5.89 22.425 4.615 21.565 3.525 20.475C2.435 19.385 1.575 18.1123 0.945 16.657C0.315 15.2017 0 13.6467 0 11.992C0 10.3373 0.315 8.785 0.945 7.335C1.575 5.885 2.435 4.615 3.525 3.525C4.615 2.435 5.88766 1.575 7.34298 0.945C8.7983 0.315 10.3533 0 12.008 0C13.6627 0 15.215 0.315 16.665 0.945C18.115 1.575 19.385 2.435 20.475 3.525C21.565 4.615 22.425 5.88532 23.055 7.33596C23.685 8.7866 24 10.3366 24 11.986C24 13.6353 23.685 15.19 23.055 16.65C22.425 18.11 21.565 19.385 20.475 20.475C19.385 21.565 18.1147 22.425 16.664 23.055C15.2134 23.685 13.6634 24 12.014 24ZM12 22.2C13.1 22.2 14.175 22.04 15.225 21.72C16.275 21.4 17.31 20.84 18.33 20.04C17.31 19.32 16.27 18.77 15.21 18.39C14.15 18.01 13.08 17.82 12 17.82C10.92 17.82 9.85 18.01 8.79 18.39C7.73 18.77 6.69 19.32 5.67 20.04C6.69 20.84 7.725 21.4 8.775 21.72C9.825 22.04 10.9 22.2 12 22.2ZM12 11.1C12.68 11.1 13.235 10.885 13.665 10.455C14.095 10.025 14.31 9.47 14.31 8.79C14.31 8.11 14.095 7.555 13.665 7.125C13.235 6.695 12.68 6.48 12 6.48C11.32 6.48 10.765 6.695 10.335 7.125C9.905 7.555 9.69 8.11 9.69 8.79C9.69 9.47 9.905 10.025 10.335 10.455C10.765 10.885 11.32 11.1 12 11.1Z' fill='black' />
                    </svg>
                </div>
                <div >
                    <p className='text-start font-semibold text-base leading-[19.5px]'>Te transfirió</p>
                    <div className='flex gap-2 mt-3'>
                        <div className='relative'>
                            <svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'>
                                <circle cx='24' cy='24' r='23' stroke='#333333' strokeOpacity='0.1' strokeWidth='2' />
                            </svg>
                            <div className='absolute top-3 left-3'>
                                <svg width='22' height='24' viewBox='0 0 22 24' fill='none' xmlns='http://www.w3.org/2000/svg'>
                                    <path d='M0 23.9593V0C0.0135661 0 0.0491594 0.00168768 0.10678 0.00506396C0.1644 0.00846057 0.244058 0.0610066 0.345753 0.162702L1.48476 1.30168C1.59323 1.41016 1.70848 1.46441 1.83051 1.46441C1.95254 1.46441 2.06779 1.41016 2.17626 1.30168L3.31527 0.162702C3.42374 0.0542337 3.53899 0 3.66102 0C3.78305 0 3.8983 0.0542337 4.00677 0.162702L5.14578 1.30168C5.25424 1.41016 5.3695 1.46441 5.49153 1.46441C5.61356 1.46441 5.72882 1.41016 5.83728 1.30168L6.97629 0.162702C7.08475 0.0542337 7.20001 0 7.32204 0C7.44407 0 7.55933 0.0542337 7.66779 0.162702L8.8068 1.30168C8.91527 1.41016 9.03052 1.46441 9.15255 1.46441C9.27458 1.46441 9.38984 1.41016 9.4983 1.30168L10.6373 0.162702C10.7458 0.0542337 10.861 0 10.9831 0C11.1051 0 11.2203 0.0542337 11.3288 0.162702L12.4678 1.30168C12.5763 1.41016 12.6915 1.46441 12.8136 1.46441C12.9356 1.46441 13.0509 1.41016 13.1593 1.30168L14.2983 0.162702C14.4068 0.0542337 14.522 0 14.6441 0C14.7661 0 14.8814 0.0542337 14.9898 0.162702L16.1288 1.30168C16.2373 1.41016 16.3526 1.46441 16.4746 1.46441C16.5966 1.46441 16.7119 1.41016 16.8203 1.30168L17.9593 0.162702C18.0678 0.0542337 18.1831 0 18.3051 0C18.4271 0 18.5424 0.0542337 18.6509 0.162702L19.7899 1.30168C19.8983 1.41016 20.0136 1.46441 20.1356 1.46441C20.2576 1.46441 20.3729 1.41016 20.4814 1.30168L21.6204 0.162702C21.7221 0.0610066 21.8017 0.00846057 21.8593 0.00506396C21.917 0.00168768 21.9526 0 21.9661 0V23.9593C21.9526 23.9593 21.917 23.9644 21.8593 23.9746C21.8017 23.9848 21.7221 23.939 21.6204 23.8373L20.4814 22.6983C20.3729 22.5898 20.2576 22.5356 20.1356 22.5356C20.0136 22.5356 19.8983 22.5898 19.7899 22.6983L18.6509 23.8373C18.5424 23.9458 18.4271 24 18.3051 24C18.1831 24 18.0678 23.9458 17.9593 23.8373L16.8203 22.6983C16.7119 22.5898 16.5966 22.5356 16.4746 22.5356C16.3526 22.5356 16.2373 22.5898 16.1288 22.6983L14.9898 23.8373C14.8814 23.9458 14.7661 24 14.6441 24C14.522 24 14.4068 23.9458 14.2983 23.8373L13.1593 22.6983C13.0509 22.5898 12.9356 22.5356 12.8136 22.5356C12.6915 22.5356 12.5763 22.5898 12.4678 22.6983L11.3288 23.8373C11.2203 23.9458 11.1051 24 10.9831 24C10.861 24 10.7458 23.9458 10.6373 23.8373L9.4983 22.6983C9.38984 22.5898 9.27458 22.5356 9.15255 22.5356C9.03052 22.5356 8.91527 22.5898 8.8068 22.6983L7.66779 23.8373C7.55933 23.9458 7.44407 24 7.32204 24C7.20001 24 7.08475 23.9458 6.97629 23.8373L5.83728 22.6983C5.72882 22.5898 5.61356 22.5356 5.49153 22.5356C5.3695 22.5356 5.25424 22.5898 5.14578 22.6983L4.00677 23.8373C3.8983 23.9458 3.78305 24 3.66102 24C3.53899 24 3.42374 23.9458 3.31527 23.8373L2.17626 22.6983C2.06779 22.5898 1.95254 22.5356 1.83051 22.5356C1.70848 22.5356 1.59323 22.5898 1.48476 22.6983L0.345753 23.8373C0.244058 23.939 0.1644 23.9848 0.10678 23.9746C0.0491594 23.9644 0.0135661 23.9593 0 23.9593ZM4.61694 17.7763H17.4305C17.7221 17.7763 17.9644 17.6797 18.1577 17.4864C18.3509 17.2932 18.4475 17.0508 18.4475 16.7593C18.4475 16.4678 18.3509 16.2254 18.1577 16.0322C17.9644 15.839 17.7221 15.7424 17.4305 15.7424H4.61694C4.32542 15.7424 4.08305 15.839 3.88983 16.0322C3.69661 16.2254 3.6 16.4678 3.6 16.7593C3.6 17.0508 3.69661 17.2932 3.88983 17.4864C4.08305 17.6797 4.32542 17.7763 4.61694 17.7763ZM4.61694 13.0169H17.4305C17.7221 13.0169 17.9644 12.9203 18.1577 12.7271C18.3509 12.5339 18.4475 12.2915 18.4475 12C18.4475 11.7085 18.3509 11.4661 18.1577 11.2729C17.9644 11.0797 17.7221 10.9831 17.4305 10.9831H4.61694C4.32542 10.9831 4.08305 11.0797 3.88983 11.2729C3.69661 11.4661 3.6 11.7085 3.6 12C3.6 12.2915 3.69661 12.5339 3.88983 12.7271C4.08305 12.9203 4.32542 13.0169 4.61694 13.0169ZM4.61694 8.2373H17.4305C17.7221 8.2373 17.9644 8.14069 18.1577 7.94746C18.3509 7.75424 18.4475 7.51186 18.4475 7.22032C18.4475 6.92881 18.3509 6.68644 18.1577 6.49322C17.9644 6.29999 17.7221 6.20338 17.4305 6.20338H4.61694C4.32542 6.20338 4.08305 6.29999 3.88983 6.49322C3.69661 6.68644 3.6 6.92881 3.6 7.22032C3.6 7.51186 3.69661 7.75424 3.88983 7.94746C4.08305 8.14069 4.32542 8.2373 4.61694 8.2373ZM2.03388 20.9492H19.9322V3.05082H2.03388V20.9492Z' fill='#333333' fillOpacity='0.4' />
                                </svg>
                            </div>
                        </div>
                        <div className='text-start'>
                            <p className='font-semibold text-sm leading-[17.07px]'>{person}</p>
                            <p className='font-semibold text-xs leading-[17.07px]'>CVU: {cvu}</p>
                        </div>
                    </div>
                </div>
            </div>

            <div className=' h-[200px] bg-white mt-4 rounded-[10px] shadow-cardShadow'>
                <div className='flex gap-[11px] p-[18px] border-b-2 border-solid border[#BEBEBE]'>
                    <svg width="18" height="21" viewBox="0 0 18 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 21C9.71667 21 9.47917 20.9042 9.2875 20.7125C9.09583 20.5208 9 20.2833 9 20C9 19.7167 9.09583 19.4792 9.2875 19.2875C9.47917 19.0958 9.71667 19 10 19H16V18H14C13.45 18 12.9792 17.8042 12.5875 17.4125C12.1958 17.0208 12 16.55 12 16V12C12 11.45 12.1958 10.9792 12.5875 10.5875C12.9792 10.1958 13.45 10 14 10H16V9C16 7.06667 15.3167 5.41667 13.95 4.05C12.5833 2.68333 10.9333 2 9 2C7.06667 2 5.41667 2.68333 4.05 4.05C2.68333 5.41667 2 7.06667 2 9V10H4C4.55 10 5.02083 10.1958 5.4125 10.5875C5.80417 10.9792 6 11.45 6 12V16C6 16.55 5.80417 17.0208 5.4125 17.4125C5.02083 17.8042 4.55 18 4 18H2C1.45 18 0.979167 17.8042 0.5875 17.4125C0.195833 17.0208 0 16.55 0 16V9C0 7.76667 0.2375 6.60417 0.7125 5.5125C1.1875 4.42083 1.83333 3.46667 2.65 2.65C3.46667 1.83333 4.42083 1.1875 5.5125 0.7125C6.60417 0.2375 7.76667 0 9 0C10.2333 0 11.3958 0.2375 12.4875 0.7125C13.5792 1.1875 14.5333 1.83333 15.35 2.65C16.1667 3.46667 16.8125 4.42083 17.2875 5.5125C17.7625 6.60417 18 7.76667 18 9V19C18 19.55 17.8042 20.0208 17.4125 20.4125C17.0208 20.8042 16.55 21 16 21H10ZM2 16H4V12H2V16ZM14 16H16V12H14V16Z" fill="black"/>
                    </svg>
                    <p className='font-semibold text-base leading-[19.5px] '>Necesito Ayuda</p>
                </div>
                <div className='p-4 border-b-2 border-solid border[#BEBEBE] cursor-pointer'>
                    <p className='font-semibold text-base leading-[19.5px] text-start'>Qué pasa si quiero cancelar el ingreso de dinero</p>
                </div>

                <div className='p-4 cursor-pointer'>
                    <p className='font-semibold text-base leading-[19.5px] text-start'>Mi dinero aún no se acreditó</p>
                </div>
            </div>
        </div>
    )
}

const Details = () => {
    const [data, setData] = useState([])
    const { user } = useSelector((state) => state.auth);
    //Token provicional
    //let token2 = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2NDc2YjU1YzI4Y2I5N2FhZWJiNzliZDMiLCJpYXQiOjE2ODU1NjQwNDMsImV4cCI6MTc3MTk2NDA0M30.fMWtq__N1sSKJlqJWdfp2TCi_j7evok6be2CGPDaWp8"

    const { id } = useParams()
    const token = user.token.token;

    useEffect(() => {
        const instance = axios.create({
            baseURL: 'https://api-wallet.onrender.com',
            headers: {'Authorization': token }
        });

        instance.get(`/auth/activity/activities/${user.update._id}`) //.UserAccountId
        .then(response => {
            setData(response.data.activities)
        })
    }, [])

    return (
        <>
            <Header dato={'Detalle de Operación'} />
            {
                data.map((item, index) => (
                   item._id === id ? <ItemView created={item.updatedAt}  id={item._id} money={item.amount}  person={item.destinyAccountId.fullname} cvu={item.destinyAccountId.cvu}  key={index} /> : null
                ))
            }
        </>
    )
}

export default Details